BlackJack
=========

BlackJack – Игра имплементирана во Windows Forms со помош на C#.
Автори на играта: 

•	Горан Петковски 111162

•	Јане Џумерковски

•	Виктор Илиески

Изворниот код од играта може да се најде на github: http://www.github.com/decob/blackjack

      1.	Опис на апликацијата

Нашата проектна задача се состои во имплементација на играта BlackJack, која претставува хазардска игра, притоа користејќи лесна и едноставна симулација. Подолу е дадено едно кратко упатство како се игра BlackJack, притоа во нашата игра се имплементарни елементарните акции.
      2.	Упатство за играње
      
      2.1 Правила на играта
Блек Џек е игра која се игра со еден или повеќе шпилови од 52 карти. Картите од 2 до 10 имаат вредност колку што е вредноста испишана на картата.  "Кралот" (К) , "кралицата" (Q), и "џандарот" (J)  имаат вредност 10, а "кецовите" можат да имаат вредност 1 или 11. Целта на играчот е да собери карти чиј што збир ќе биде поблиску до 21 ( но без да надмине 21), одколку збирот на делачот.
Во играта Блек Џек секој играч игра против делачот, и обратно. Максимум број на играчи во оваа игра е 5. Минимален влог е 50 денари, а максимален влог е 5000 денари.

На почетокот од играта секој играч добива по две кари. Доколку играчот со тие две карти има збир 21 тоа се нарекува Блек Џек. За Блек Џек се исплаќа 3 за 2. Тоа значи за влог од 50 денари, вас ќе ви бида исплатени 75 денари (или вкупно 125 денари), што е повеќе од обична победа кога ќе ви бида исплатени 2 за 1 односно 50 денари (или вкупно 100 денари). 
Опции кои може да ги избере секој играч во даден момент се: Hit, Stand, Double down, Surrender.

Редоследот на игра е од лево кон десно од гледна точка на делачот. Откако сите играчи ќе завршат , делачот игра според стандардни правила: делачот мора да зема карта се додека има 16 или помалку, и мора да заврши со земање на карта кога ќе има збир 17 или поголем.

Објаснување на опциите кои му се понудени на секој играч:
HIT - значи дека играчот побарува уште една карта. Може да се употребува ова копче (опција) колку пати што сака играчот се додека не надмине 21 (Губи) или  се одлучи на STAND.

STAND - значи дека играчот не сака да зема повеќе карти.  

DOUBLE DOWN -  значи дека играчот сака да го удвои влогот кој веќе го има и на играчот му се доделува само уште една карта.Играчот може да го (ја) употреби ова(а) копче (опција) само кога ќе му бида доделени првите две карти.

SURRENDER - значи дека играчот се откажува од "раката". Играчот може да го (ја) употреби ова(а) копче (опција) само кога ќе му бида доделени првите две карти. Половина од влогот му се враќа.

      2.2	Упатство за користење на играта
Најпрвин на секој играч му е даден приказ на основниот прозорец во кој има четири опции (истите се прикажани со помош на слики за да биде повпечатливо)

Овој прозорец може да не одведе во еден од следните четири прозорци (Главна игра, Број на играчи, Помош, како и веб-прелистувач во зависност од иконата која е кликната).

      2.3	Прозорец Број на Играчи
Како што може да се забележи од фотографијата дадена подолу имаме повеќе опции на оваа игра. Имаме опција за додавање на Нов Играч (што ќе претставува исцртување на едно ново иконче на екранот, со опциите за име и влог, односно додавање на нов играч), или одземање на еден играч (што ќе претставува еден играч да се отстрани од листата на играчи). Исто така имаме и едно поголемо копче кое се активира само доколку имаме избрано барем еден играч. Подолу е даден пример со избрани 3 играчи со нивни соодветни имиња и влогови.


      2.4	Прозорец Главна Игра 
На овој прозорец се одвива целата логика од играта. Имено врз основа на бројот на играчите од претходниот прозорец (Број на Играчи), се прикажува прозорецот со игра. Масата е распределена за максимум 5 играчи и 1 делач. Откако ќе започни играта започнува да отчукува тајмерот за игра (горен десен агол), исто така имаме и тајмер за моментално време (горен лев агол).
На сликата се прикажани неколку контроли и опции. Еден играч е активен доколку кај него ќе бидат прикажани четирите копчиња (HIT, STAND, DOUBLE DOWN, SURRENDER), во меѓувреме тајмерот за избор истекува (максимум 120 секунди). Исто така во секој момент може да се Паузира играта (со клик на копчето Паузирај ја играта), потоа да се продолжи со играта, или да се креира Нова Игра (со истиот број на играчи). Доколку некој играч добие збир на карти 21, тогаш името на добитникот (играч или делач), се исполнува во листата на добитници со нивната добивка. Во другата листа се дадени бројот на играчи (имиња, збир на карти и нивниот влог) која се ажурира со секое играње на играчот.

      3.	Решение на проблемот
      3.1	Податочни структури и класи
      
За решавање на проблемот се користени неколку класи и податочни структури. Главни класи во играта претставуваат: Player, Karta, usedCards и Glavna Igra.



Во класата Karta чуваме информации кои се поврзани за картата и тоа:

      •	Broj – Соодветна Int- променлива која го репрезентира бројот на картата (ограничена на 1-14)

      •	Boja – Соодветна Int- променлива која претставува бојата на картата (ограничена на 1-4). Секој број претставува една боја и тоа (1- детелина, 2- црн лист, 3- каро, 4-срце)

      •	usedCards- Референца кон UsedCards-променлива која репрезентира матрица на употребени карти.

      •	Image- Референца кон Image објект кој се генерира во зависност од бројката и бојата.

      •	Player- Референца кон Player- објект кој означува играч кој ја користи оваа карта.

UsedCards ни претставува помошна структура која ќе го чува бројот и бојата на извлечените карти , имплементирано со дво-димензионална bool- матрица 4(боја)х14(број)  која за секое поле прима две вредности (true-извлечена) или (false- неизвлечена).

Со помош на Random ќе го изведеме извлекувањето на картите (првин се прави проверка дали веќе била извлечена, со помош на Used Cards), доколку не е, се инстанцира една нова Karta со соодветните информации. 

Во класата Player чуваме неколку информации:

      •	List<Karta> - Листата од карти за соодветниот играч
      
      •	Aktiven – Bool променлива која опишува дали играчот сеуште игра или изгубил

      •	Otkazi – Bool променлива која означува дали играчот се откажал

      •	Ime – Името на играчот

      •	Broj Na Karti – Збирот од картите кои ги поседува играчот

      •	Vlog – Влогот со кој игра играчот

Во класата Glavna Igra се чуваат следните податоци:

      •	List<Player>- Репрезентира Листа на Активни играчи
      
      •	TimerIgrac- Тајмер кој го репрезентира времето на секој играч
      
      •	Brojac- Int променлива која репрезентира бројот на секунди кои му преостануваат на играчот
      
      •	Aktiven Igrac- Референца кон Player објект, кој е активен играч во моментот (само еден играч во даден момент може да изигра)
      
      •	Random- Референца кон Random објект, за генерирање на различни карти
      
      •	Dealer- Референца кон Dealer објект кој го репрезентира Делачот во играта (постои само еден Делач)

      3.2	Функции и класи кои се користат
      
      Главната функција која се користи за генерирање на карти е generirajKarta() во класата Karta.
      
      public void generirajKarta()
        {
            int broj1;
            int broj2;
            while (true)
            {
                broj1 = re.Next(1, 4);
                broj2 = re.Next(2, 14);
                if (!upotrebeniKarti.zafatenaKarta(broj2-1, broj1-1))
                {
                    upotrebeniKarti.dodajKarta(broj2-1, broj1-1);
                    this.broj = broj2;
                    this.boja = broj1;
                    break;
                }}}
     
Оваа функција има задача да генерира карта која досега не била извлечена. За таа цел со помош на re (Random променлива), се извлекува еден број од соодветниот ранг. Потоа доколку картата не била извлечена (проверка со upotrebeniKarti), се доделува картата. Доколку се најди барем една карта се напушта while- циклусот, во спротивен случај се продолжува со извршување се додека не се најди неизвлечена карта.

Функциите кои се наоѓаат во класата UsedCards се:

public void dodajKarta(int broj, int boja)
        {
            upotrebeniKarti[boja, broj] = true;
        }
public bool zafatenaKarta(int broj, int boja)
        {
            return upotrebeniKarti[boja, broj];
        }
        
Првата функција има задача да додади една карта во матрицата на зафатени карти, додека втората има задача да врати вредност дали картата била зафатена (со помош на вредностите broj и boja).
Следната функција има задача да го испише името на добитникот во играта како и неговата добивка:

public void pobednikNaIgrata()
        {
            timerIgrac.Stop();
            brojac=0;
            aktivenIgrac.vlog= aktivenIgrac.vlog+(int)(aktivenIgrac.vlog*1.50);
            aktivenIgrac.pobednik = true;
            aktivenIgrac.igra = false;
            DialogResult d = MessageBox.Show("Играчот: "+String.Format("{0}", aktivenIgrac.ime)+" доби BlackJack. Неговата добивка изнесува"+String.Format("{0}", (aktivenIgrac.vlog+(int)(aktivenIgrac.vlog*1.25))), "BlackJack.", MessageBoxButtons.OK, MessageBoxIcon.Warning);
            ispolnilistapobednik();
            if ((igraci.Count > aktivenIgrac.id_igr) && (igraci[aktivenIgrac.id_igr] != null))
            {
                aktivenIgrac = igraci[aktivenIgrac.id_igr];
                aktivenIgrac.PostaviAktiven();
            }
            else
            {
                otvoriKartaDealer();
            }
        }

Оваа функција најпрвин започнува со запирање на тајмерот. Потоа се поставуваат соодветните променливи (pobednik-true значи дадениот играч е добитник, igra-false значи дека играчот не е повеќе активен во играта). Со MessageBox се испишува името на добитникот, и неговата добивка (добивката се добива како збир на тековниот влог и 125% (односно 3 за 2) од вредноста на влогот). Потоа со помош на функцијата ispolnilistapobednik(), се исполнува листата со добитници во прозорецот, потоа се врши проверка дали имаме нареден играч после овој играч, доколку нема значи дека следен играч е Делачот, затоа се извршува функцијата otvoriKartaDealer(). 
